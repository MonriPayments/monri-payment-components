<!DOCTYPE html>
<html lang="en" data-critters-container>
<head>
  <meta charset="utf-8">
  <title>Google Pay</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<body>
<div id="google-pay-component"></div>
<script>
  const script = document.createElement('script');
  script.src = `./dist/google-pay-app/google-pay-bundle.js`;
  script.async = true;
  script.onload = () => {
    console.log('Script loaded');
  };
  script.onerror = () => {
    console.log('Error occurred while loading script');
  };

  document.body.appendChild(script);

  const googlePayElement = document.createElement('lib-google-pay')

  getGoogleInputParameters(googlePayElement);

  const googlePayComponent = document.getElementById('google-pay-component');
  googlePayComponent.appendChild(googlePayElement);

  document.body.appendChild(googlePayComponent);

  function getGoogleInputParameters() {
    const googleTransactionInfo = {
      displayItems: [
        {
          label: 'Subtotal',
          type: 'SUBTOTAL',
          price: '2.00'
        },
        {
          label: 'Tax',
          type: 'TAX',
          price: '1.00'
        }
      ],
      countryCode: 'US',
      currencyCode: 'USD',
      totalPriceStatus: 'FINAL',
      totalPrice: '3.00',
      totalPriceLabel: 'Total'
    };
    googlePayElement.googleTransactionInfo = googleTransactionInfo;

    googlePayElement.googlePaymentDataRequest = {
      apiVersion: 2,
      apiVersionMinor: 0,
      allowedPaymentMethods: [
        {
          type: 'CARD',
          parameters: {
            allowedAuthMethods: ['PAN_ONLY', 'CRYPTOGRAM_3DS'],
            allowedCardNetworks: [
              'AMEX',
              'DISCOVER',
              'INTERAC',
              'JCB',
              'MASTERCARD',
              'VISA'
            ]
          },
          tokenizationSpecification: {
            type: 'PAYMENT_GATEWAY',
            parameters: {
              gateway: 'example',
              gatewayMerchantId: 'exampleGatewayMerchantId'
            }
          }
        }
      ],
      transactionInfo: googleTransactionInfo,
      merchantInfo: {
        merchantId: 'BCR2DN4TQHE6DYLO',
        merchantName: 'Harun'
      },
      callbackIntents: ['PAYMENT_AUTHORIZATION']
    };

    const baseCardPaymentMethod = {
      type: 'CARD',
      parameters: {
        allowedAuthMethods: ['PAN_ONLY', 'CRYPTOGRAM_3DS'],
        allowedCardNetworks: ['MASTERCARD', 'VISA']
      }
    };
    googlePayElement.googleIsReadyToPayRequest = {
      apiVersion: 2,
      apiVersionMinor: 0,
      allowedPaymentMethods: [baseCardPaymentMethod]
    };
    googlePayElement.googleErrorState = {
      intent: 'PAYMENT_AUTHORIZATION',
      message:
        'Insufficient funds, try again. Next attempt should work.',
      reason: 'PAYMENT_DATA_INVALID'
    }
    googlePayElement.googleTransactionState = {
      onSuccess: 'SUCCESS',
      onError: 'ERROR'
    }
    googlePayElement.googleEnvironment = 'TEST'
  }
</script>
</body>
</html>
